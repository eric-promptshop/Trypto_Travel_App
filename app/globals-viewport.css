/* Viewport and Layout Fixes for Snappy UI */

/* Use dynamic viewport height for mobile devices */
:root {
  --vh: 1vh; /* Fallback */
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
  --keyboard-height: 0px;
}

/* Prevent overscroll and bounce effects */
html {
  overscroll-behavior: none;
  -webkit-overflow-scrolling: touch;
}

body {
  overscroll-behavior: none;
  /* Removed fixed positioning to allow normal scrolling */
}

/* Main app container */
#__next,
.app-container {
  position: relative;
  width: 100%;
  height: 100vh;
  height: 100dvh;
}

/* Mobile chat container */
@supports (-webkit-touch-callout: none) {
  .mobile-chat-container {
    height: 100vh;
    position: relative;
    display: flex;
    flex-direction: column;
  }
}

/* Ensure full viewport height without scrollbars */
.h-screen-safe {
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height */
  height: calc(var(--vh, 1vh) * 100);
}

/* Mobile-specific viewport fixes */
@supports (-webkit-touch-callout: none) {
  .h-screen-safe {
    height: -webkit-fill-available;
  }
}

/* Chat container that fits perfectly */
.chat-container {
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Messages area with iOS-style scrolling */
.messages-container {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  overscroll-behavior-y: contain;
  
  /* iOS rubber-band scrolling */
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  
  /* Smooth momentum scrolling */
  scroll-snap-type: y proximity;
}

/* iOS-style minimal scrollbars */
.messages-container::-webkit-scrollbar {
  width: 3px;
}

.messages-container::-webkit-scrollbar-track {
  background: transparent;
}

.messages-container::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.15);
  border-radius: 1.5px;
  transition: background 0.2s ease;
}

.messages-container:hover::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.3);
}

/* Hide scrollbar on mobile for iOS feel */
@media (max-width: 768px) {
  .messages-container::-webkit-scrollbar {
    display: none;
  }
  
  .messages-container {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
}

/* Input area that stays fixed */
.input-container {
  flex-shrink: 0;
  position: relative;
  background: white;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: env(safe-area-inset-bottom);
}

/* Prevent input zoom on iOS */
@media (max-width: 768px) {
  input[type="text"],
  input[type="email"],
  input[type="password"],
  textarea {
    font-size: 16px !important;
  }
}

/* Smooth transitions for layout changes */
.layout-transition {
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
              opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Prevent layout shift during loading */
.skeleton-loader {
  background: linear-gradient(
    90deg,
    rgba(0, 0, 0, 0.05) 25%,
    rgba(0, 0, 0, 0.1) 50%,
    rgba(0, 0, 0, 0.05) 75%
  );
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Container queries for responsive scaling */
@container (min-width: 768px) {
  .container-responsive {
    padding: 2rem;
  }
}

@container (max-width: 767px) {
  .container-responsive {
    padding: 1rem;
  }
}